<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title> 대기질 예측 - 텐서플로우를 활용한</title>
    <!-- css -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="https://bootswatch.com/4/materia/bootstrap.min.css">
    <link rel="stylesheet" href="https://bootswatch.com/4/materia/bootstrap.css">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/madecss.css" rel="stylesheet">
    <!-- weathericon -->
    <link type="text/css" rel="stylesheet" href="css/weather-icons.min.css">
    <!-- font awesome -->
    <script src="https://kit.fontawesome.com/e0de2813f8.js" crossorigin="anonymous"></script>
 </head>
  <body>
    <header class="hero-wrap text-center mb-0 bg-hd text-dark" style="background-image: url(./file/cloudback1.gif);" data-stellar-background-ratio="0.5">
      <div class="overlay"></div>
        <div class="container">
          <div class="dre row description align-items-center justify-content-center">
            <div class="col-sm-10 text-left">
              <div class = 'CurrIcon cIT'></div>
              <div class = 'CurrTemp cIT'></div>
              <a href="#" onclick="getLocation()"><span class="but-gps fas fa-map-marker-alt"></span></a>
              <div class = 'City ciD'></div>
              <div class="CurrDescription ciD"></div>
              </div>
            </div>
          </div>
    </header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-light navbar-right bg-white bg-hd">
      <!-- <a class="navbar-brand" href="./index.html"> ⓉAQ-P(임시로고) </a> -->
      <span id="dpTime"></span>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarColor02">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="./index.html"> 홈 <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item navmy">
            <a class="nav-link" href="./menu-2.html"> 실시간 정보 </a>
          </li>
          <li class="nav-item navmy">
            <a class="nav-link" href="./menu-3.html"> 예측 정보</a>
          </li>
          <li class="nav-item navmy">
            <a class="nav-link" href="#"> About </a>
          </li>
        </ul>
      </div>
    </nav>
    <section>
      <article>
        <a href="#" class="top">︽</a>
      </article>
      <article class="container pt-1">
        <div class="row">
          <div class="col-sm-5">
            <div class="card border-primary mb-3" style="max-width: 100rem;">
              <div class="card-body">
                <!-- <i class="far fa-grin-squint" style="color:blue; font-size: 80px;"></i> -->
                <i class="fas fa-grin-squint" style="color:#0066ff; font-size: 80px; padding-right:10px;"></i>
                <!-- <i class="far fa-smile" style="color:green; font-size: 80px;"></i> -->
                <i class="fas fa-smile" style="color:#009933; font-size: 80px; padding-right:10px;"> </i>
                <!-- <i class="far fa-frown" style="color:yellow; font-size: 80px;"></i> -->
                <i class="fas fa-frown" style="color:#ffcc00; font-size: 80px; padding-right:10px;"> </i>
                <i class="fas fa-dizzy" style="color:#ff1a1a; font-size: 80px;"></i>
              </div>
            </div>
          </div>
          <div class="col-sm-7">
            <div class="card border-primary mb-3" style="max-width: 100rem;">
              <div class="card-body">
              </div>
            </div>
          </div>
        </div>
      </article>
      <article class="container pt-4">
        <div class="card border-primary mb-3" style="max-width: 100rem;">
          <div class="card-body">
            <div class="card-title">
              <h3>예측 데이터</h3>
            </div><hr/>
            <div class="row pt-3">
              <div class="col-sm-6">
                <div class="card-box">
                  <h4> O<sub>3</sub> </h4><br/>
                  <div id="lineChart-1"></div><br/>
                </div>
              </div>
              <div class="col-sm-4">
                <div class="card-box">
                  <h4> PM<sub>10</sub> </h4><br/>
                  <div id="lineChart-2"></div><br/>
                </div>
              </div>
            </div>
            <div class="row pt-3">
              <div class="col-sm-6">
                <div class="card-box">
                  <h4> PM<sub>2.5</sub> </h4><br/>
                  <div id="lineChart-3"></div><br/>
                </div>
              </div>
              <div class="col-sm-4">
                <div class="card-box">
                  <h4> CO </h4><br/>
                  <div id="lineChart-4"></div><br/>
                </div>
              </div>
            </div>
          </div>
        </div>
      </article>
    </section>
    <footer>
      <div class="jumbotron text-center mt-5 mb-0 bg-main">
        <p><small>20.3.11) 텐서플로우를 활용한 대기질 예측 정보제공 사이트.<br/>자료제공:공공데이터/에어코리아/오픈웨더맵.<br/>by <span class="text-info">이상찬,차민규,이도연,정윤진</span></small></p>
      </div>
    </footer>
    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <!-- bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="plugins/common/common.min.js"></script>
    <!-- sparkline.js -->
    <script src="plugins/jquery.sparkline/jquery.sparkline.min.js"></script>
    <!-- chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.min.js" integrity="sha256-TQq84xX6vkwR0Qs1qH5ADkP+MvH0W+9E7TdHJsoIQiM=" crossorigin="anonymous"></script>
    <!--  flot-chart js -->
    <script src="plugins/flot/js/jquery.flot.min.js"></script>
    <script src="plugins/flot/js/jquery.flot.pie.js"></script>
    <script src="plugins/flot/js/jquery.flot.resize.js"></script>
    <script src="plugins/flot/js/jquery.flot.spline.js"></script>
    <script src="plugins/flot/js/jquery.flot.init.js"></script>
    <!-- javascript -->
    <script src="js/madejs.js"></script>
    <script type="text/javascript">
      //날씨
  let weatherIcon = {
    // dayIcon
    '01d' : 'wi wi-day-sunny',
    '02d' : 'wi wi-day-cloudy',
    '03d' : 'wi wi-cloud',
    '04d' : 'wi wi-cloudy',
    '09d' : 'wi wi-day-showers',
    '10d' : 'wi wi-day-rain',
    '11d' : 'wi wi-day-lightning',
    '13d' : 'wi wi-day-snow',
    '50d' : 'wi wi-day-fog',
    // nightIcon
    '01n' : 'fas fa-moon',
    '02n' : 'wi wi-night-alt-cloudy',
    '03n' : 'wi wi-cloud',
    '04n' : 'wi wi-cloudy',
    '09n' : 'wi wi-night-alt-showers',
    '10n' : 'wi wi-night-alt-rain',
    '11n' : 'wi wi-night-alt-lightning',
    '13n' : 'wi wi wi-night-alt-snow',
    '50n' : 'wi wi-night-fog'
  };
  let weatherDescription = {
    '200' : '약한 비를 동반한 천둥번개',
    '201' : '비를 동반한 천둥번개',
    '202' : '폭우를 동반한 천둥번개',
    '210' : '약한 천둥번개',
    '211' : '천둥번개',
    '212' : '강한 천둥번개',
    '221' : '불규칙적인 천둥번개',
    '230' : '번개와 약한 이슬비',
    '231' : '번개를 동반한 이슬비',
    '232' : '번개와 굵은 이슬비',
    '300' : '약한 이슬비',
    '301' : '이슬비',
    '302' : '강한 이슬비',
    '310' : '가벼운 보슬비',
    '311' : '약한 비',
    '312' : '강한 보슬비',
    '313' : '소나기성 안개비',
    '314' : '강한 소나기성 안개비',
    '321' : '소나기',
    '500' : '약한 비',
    '501' : '비',
    '502' : '강한 비',
    '503' : '거센 비',
    '504' : '집중호우',
    '511' : '우박',
    '520' : '약한 소나기',
    '521' : '소나기',
    '522' : '강한 소나기',
    '531' : '불규칙적인 소나기',
    '600' : '가벼운 눈',
    '601' : '눈',
    '602' : '강한 눈',
    '611' : '진눈깨비',
    '612' : '소나기성 진눈깨비',
    '615' : '약한 비와 눈',
    '616' : '비내리고 눈',
    '620' : '약한 소나기성 눈',
    '621' : '소나기성 눈',
    '622' : '강한 소나기성 눈',
    '701' : '안개',
    '711' : '스모그',
    '721' : '옅은 안개',
    '731' : '황사',
    '761' : '먼지낌',
    '762' : '화산재',
    '771' : '돌풍',
    '781' : '토네이도',
    '800' : '맑음',
    '801' : '구름 조금',
    '802' : '구름 많음',
    '803' : '구름 적고 맑음',
    '804' : '구름 많고 흐림',
    '900' : '토네이도',
    '901' : '태풍',
    '902' : '허리케인',
    '903' : '한파',
    '904' : '열대야',
    '905' : '바람 많음',
    '906' : '우박',
    '951' : '바람 없음',
    '952' : '약한 바람',
    '953' : '산들 바람',
    '954' : '바람',
    '955' : '선선한 바람',
    '956' : '강한 바람',
    '957' : '거센 바람',
    '958' : '돌풍',
    '959' : '심한 돌풍',
    '960' : '폭풍',
    '961' : '강한 폭풍',
    '962' : '허리케인'
  }
  let currentCity = {
    'Yongsan' : '서울특별시 용산구',
    'Pyeongtaek-si' : '경기도 평택시',
    'Seonghwan' : '충청남도 천안시 서북구 성환읍'
  }
  var $LatitudeData=37.553828; //초기값 서울역
  var $LongitudeData=126.969652;
  $.ajax({
    url: "http://api.openweathermap.org/data/2.5/weather?APPID=19cf2b4d24f78ab577061da24b4c9a2d&units=metric&lat="+$LatitudeData+'&lon='+$LongitudeData+" ",
    dataType: 'json',
    type: 'GET',
    success: function(data){
      var $Icon = (data.weather[0].icon).substr(0.3);
      var $Temp = Math.floor(data.main.temp) + '℃';
      var $city = data.name;
      var $Description = data.weather[0].id;
      $('.CurrIcon').append('<i class="' + weatherIcon[$Icon] + '"></i>');
      $('.CurrTemp').prepend($Temp);
      $('.City').append(currentCity[$city]);
      $('.CurrDescription').append(weatherDescription[$Description]);
    }
  })
  // 위치
  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition, showError);
    } else {
      alert("이 브라우저에서는 Geolocation을 지원하지 않습니다.");
    }
  }
  function showPosition(position) {
    $LatitudeData=position.coords.latitude;
    $LongitudeData=position.coords.longitude;

    $.ajax({
      url: "http://api.openweathermap.org/data/2.5/weather?APPID=19cf2b4d24f78ab577061da24b4c9a2d&units=metric&lat="+$LatitudeData+'&lon='+$LongitudeData+" ",
      dataType: 'json',
      type: 'GET',
      success: function(data){
        var $Icon = (data.weather[0].icon).substr(0.3);
        var $Temp = Math.floor(data.main.temp) + '℃';
        var $city = data.name;
        var $Description = data.weather[0].id;
        $('.CurrIcon').html('<i class="' + weatherIcon[$Icon] + '"></i>');
        $('.CurrTemp').html($Temp);
        $('.City').html(currentCity[$city]);
        $('.CurrDescription').html(weatherDescription[$Description]);
      }
    })
  }
  function showError(error) {
    switch(error.code) {
      case error.PERMISSION_DENIED:
        alert("사용자가 Geolocation 요청을 거부했습니다.")
        break;
      case error.POSITION_UNAVAILABLE:
        alert("위치 정보를 사용할 수 없습니다.")
        break;
      case error.TIMEOUT:
        alert("사용자 위치를 가져오는 요청이 시간 초과되었습니다.")
        break;
      case error.UNKNOWN_ERROR:
        alert("알 수 없는 오류가 발생했습니다.")
        break;
    }
  }
    </script>
  </body>
</html>
